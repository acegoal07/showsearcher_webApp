class SearchSettings{constructor(){this.page=1,this.maxPage=1,this.adultContent=!1,this.movieOrTv=0}}const searchSettings=new SearchSettings;function search(e){if(document.querySelector("#search-results").innerHTML="",hidePaginationButtons(),!e)return;const t={method:"GET",headers:{accept:"application/json",Authorization:"Bearer eyJhbGciOiJIUzI1NiJ9.eyJhdWQiOiI1Yzk4MTAxNjk0OTQ2MmE4NmJlNTA2NTc2Yjg1ZjZlNCIsInN1YiI6IjY2MjFkMDY1Y2NkZTA0MDE4ODA2NDA4MCIsInNjb3BlcyI6WyJhcGlfcmVhZCJdLCJ2ZXJzaW9uIjoxfQ.xUExDZr1UbIizmXNPNqotICIYYKTQfRltq2uIgq9qjI"}};hideNoResultsError(),showLoadingSpinner(),fetch(0==searchSettings.movieOrTv?`https://api.themoviedb.org/3/search/movie?query=${e}&include_adult=${searchSettings.adultContent}&page=${searchSettings.page}`:`https://api.themoviedb.org/3/search/tv?query=${e}&include_adult=${searchSettings.adultContent}&page=${searchSettings.page}`,t).then((e=>{if(e.ok)return e.json();throw new Error("Network response was not ok")})).then((e=>{const n=document.querySelector("#search-results");searchSettings.maxPage=e.total_pages,searchSettings.maxPage>1&&showPaginationButtons(),e.results.forEach((e=>{const a=document.createElement("div");a.classList.add("col");const o=document.createElement("div");if(o.classList.add("card","bg-body-tertiary","justify-content-center","h-100","shadow-lg","border-0"),a.appendChild(o),e.poster_path){const t=document.createElement("img");t.classList.add("card-img"),t.src=`https://image.tmdb.org/t/p/w500${e.poster_path}`,t.alt=e.title||e.name||e.original_title||e.original_name,o.appendChild(t)}else{const t=document.createElement("div");t.classList.add("placeholder-card-img");const n=document.createElement("img");n.classList.add("card-img"),n.src="assets/images/FillerImage.webp",n.alt=e.title||e.name||e.original_title||e.original_name,t.appendChild(n);const a=document.createElement("div");a.classList.add("placeholder-card-img-text");const r=document.createElement("div");r.classList.add("fw-bold","fs-5","pb-1"),r.textContent=e.title||e.name||e.original_title||e.original_name,a.appendChild(r);const s=document.createElement("div");s.classList.add("fs-6","text-muted","pb-1"),s.textContent=e.release_date||e.first_air_date||"No release date available",a.appendChild(s);const i=document.createElement("div");i.classList.add("fs-6","text-muted"),e.overview?i.textContent=`${e.overview.substring(0,150)} ...`:i.textContent="No overview available",a.appendChild(i);const c=document.createElement("div");c.classList.add("fs-6","text-muted","fw-bold","pt-1"),c.textContent="Click to see more",a.appendChild(c),t.appendChild(a),o.appendChild(t)}o.addEventListener("click",(()=>{fetch(0==searchSettings.movieOrTv?`https://api.themoviedb.org/3/movie/${e.id}/watch/providers`:`https://api.themoviedb.org/3/tv/${e.id}/watch/providers`,t).then((e=>{if(e.ok)return e.json();throw new Error("Network response was not ok")})).then((n=>{fetch(0==searchSettings.movieOrTv?"https://api.themoviedb.org/3/genre/movie/list?language=en":"https://api.themoviedb.org/3/genre/tv/list?language=en",t).then((e=>{if(e.ok)return e.json();throw new Error("Network response was not ok")})).then((t=>{const a=[];e.genre_ids.forEach((e=>{const n=t.genres.find((t=>t.id===e));n&&a.push(n.name)})),document.querySelector("#show-title").textContent=e.title||e.name||e.original_title||e.original_name,document.querySelector("#show-release-date").textContent=e.release_date||e.first_air_date||"No release date available",document.querySelector("#show-description").textContent=e.overview||"No overview available",document.querySelector("#show-genres").textContent=a.join(", ")||"No genres available",document.querySelector("#show-rating").textContent=parseFloat(e.vote_average).toFixed(1)||"No rating available";const o=document.querySelector("#where-to-watch");o.style.display="none";const r=document.querySelector("#buy-output");r.innerHTML="";const s=document.querySelector("#rent-output");s.innerHTML="";const i=document.querySelector("#stream-output");i.innerHTML="";const c=n.results.GB;if(c){if(o.style.display="block",c.buy)for(const e of c.buy){const t=document.createElement("p");t.textContent=e.provider_name,r.appendChild(t)}else{const e=document.createElement("p");e.textContent="No buy providers available",r.appendChild(e)}if(c.rent)for(const e of c.rent){const t=document.createElement("p");t.textContent=e.provider_name,s.appendChild(t)}else{const e=document.createElement("p");e.textContent="No rent providers available",s.appendChild(e)}if(c.flatrate)for(const e of c.flatrate){const t=document.createElement("p");t.textContent=e.provider_name,i.appendChild(t)}else{const e=document.createElement("p");e.textContent="No stream providers available",i.appendChild(e)}}$("#showData").modal("show")})).catch((e=>{}))})).catch((e=>{}))})),n.appendChild(a)})),0==e.results.length&&document.querySelector("#no-result-error").classList.contains("d-none")&&showNoResultsError(),hideLoadingSpinner()})).catch((e=>{}))}function showNoResultsError(){document.querySelector("#no-result-error").classList.remove("d-none")}function hideNoResultsError(){document.querySelector("#no-result-error").classList.add("d-none")}function showPaginationButtons(){document.querySelector("#pagination-btns").classList.remove("d-none")}function hidePaginationButtons(){document.querySelector("#pagination-btns").classList.add("d-none")}function showLoadingSpinner(){document.querySelector("#loading-spinner").classList.remove("d-none")}function hideLoadingSpinner(){document.querySelector("#loading-spinner").classList.add("d-none")}window.addEventListener("load",(function(){let e;const t=document.querySelector("#search-input");t.value=null,searchSettings.adultContent=document.querySelector("#adult-items-settings").value,document.querySelector("#adult-items-settings").addEventListener("change",(()=>{searchSettings.adultContent=document.querySelector("#adult-items-settings").value,search(t.value.trim())})),t.addEventListener("keyup",(()=>{clearTimeout(e),searchSettings.page=1,t.value&&(e=setTimeout((()=>search(t.value.trim())),200))})),document.querySelector("#select-movies").addEventListener("click",(()=>{searchSettings.movieOrTv=0,searchSettings.page=1,search(t.value.trim())})),document.querySelector("#select-tv-shows").addEventListener("click",(()=>{searchSettings.movieOrTv=1,searchSettings.page=1,search(t.value.trim())})),document.querySelector("#pagination-back-btn").addEventListener("click",(()=>{1!=searchSettings.maxPage&&(searchSettings.page-1<1?searchSettings.page=searchSettings.maxPage:searchSettings.page--,search(t.value.trim()))})),document.querySelector("#pagination-next-btn").addEventListener("click",(()=>{1!=searchSettings.maxPage&&(searchSettings.page+1>searchSettings.maxPage?searchSettings.page=1:searchSettings.page++,search(t.value.trim()))}))}));